@using Domain.Options
@using Microsoft.AspNetCore.Mvc.TagHelpers
@using Microsoft.Extensions.Options
@model Domain.DTO.ShoppingCartDTO
@inject IOptions<StripeSettings> Stripe

@{
ViewData["Title"] = "Shopping Cart";
Layout = "~/Views/Shared/_Layout.cshtml";
}

<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap">

<style>
    body {
        font-family: 'Roboto', sans-serif;
        background-color: #f1f1f1; /* Light gray background */
    }

    .container {
        margin-top: 30px;
    }

    h1 {
        font-size: 2.5rem;
        font-weight: 700;
        text-align: center;
        margin-bottom: 30px;
        color: #343a40;
    }

    .table {
        background-color: #ffffff;
        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        overflow: hidden; /* Ensures rounded corners are visible */
    }

    .table thead {
        background-color: #343a40;
        color: #ffffff;
    }

    .table th, .table td {
        vertical-align: middle;
    }

    .table td {
        color: #495057;
    }

    
     .btn-submit {
         background-color: #28a745; /* Stylish green */
         border-color: #218838; /* Slightly darker green for border */
         color: #fff; /* White text for contrast */
         font-weight: bold; /* Bold text for emphasis */
     }
    .btn-submit:hover {
        background-color: #218838; /* Darker green on hover */
        border-color: #1e7e34; /* Even darker green for border on hover */
        box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25); /* Subtle shadow for better focus */
    }


    .stripe-button {
        margin: 20px 0;
        text-align: center;
    }

    .table-footer {
        background-color: #f8f9fa;
        padding: 16px;
        border-top: 1px solid #dee2e6;
        font-weight: 700;
    }
</style>

<h1>Shopping Cart</h1>

@if (Model.TotalPrice != 0)
{
<form asp-controller="ShoppingCart" asp-action="PayOrder" method="post">
    <article class="stripe-button">
        <script src="https://checkout.stripe.com/checkout.js"
                class="stripe-button"
                data-key="@Stripe.Value.PublishableKey"
                data-locale="auto"
                data-description="EShop Application Payment"
                data-amount="@(Model.TotalPrice * 100)"
                data-label="Pay $@Model.TotalPrice">
        </script>
    </article>
</form>
}

<div class="container">
    <table class="table table-striped">
        <thead>
        <tr>
            <th>#</th>
            <th>Event Name</th>
            <th>Price</th>
            <th>Quantity</th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        @for (int i = 0; i < Model.Tickets.Count(); i++)
        {
        var item = Model.Tickets[i];
        <tr>
            <td>@(i + 1)</td>
            <td>@Html.DisplayFor(modelItem => item.Event.Name)</td>
            <td>$@Html.DisplayFor(modelItem => item.Event.EventPrice)</td>
            <td>@Html.DisplayFor(modelItem => item.Quantity)</td>
            <td>
                <a class="btn btn-submit" asp-action="DeleteFromShoppingCart" asp-route-id="@item.Id" asp-controller="ShoppingCart">Delete</a>
            </td>
        </tr>
        }
        </tbody>
        <tfoot class="table-footer">
        <tr>
            <td colspan="4"><b>Total:</b></td>
            <td><b>$@Model.TotalPrice</b></td>
        </tr>
        </tfoot>
    </table>
</div>
